(function($){window.T9={version:"2.1",register:{},isTouchDevice:"ontouchstart" in window,fitTouchDevice:function(){function simMouseEvt(type,target,pos){var evt=document.createEvent("MouseEvents");evt.initMouseEvent(type,true,true,document,0,pos.screenX,pos.screenY,pos.clientX,pos.clientY,false,false,false,false,0,target);return target.dispatchEvent(evt)}document.addEventListener("touchstart",function(e){if(!simMouseEvt("mousedown",e.target,e.changedTouches[0])){e.preventDefault();setTimeout(function(){if(e.target instanceof HTMLElement&&!e.target.getAttribute("t9movement")){simMouseEvt("click",e.target,e.changedTouches[0])}},300)}});document.addEventListener("touchmove",function(e){e.target instanceof HTMLElement&&e.target.setAttribute("t9movement","move");simMouseEvt("mousemove",e.target,e.changedTouches[0])||e.preventDefault()});document.addEventListener("touchend",function(e){var timer;if(e.target instanceof HTMLElement){if(e.target.getAttribute("t9dbclick")){clearTimeout(timer);e.target.removeAttribute("t9dbclick");simMouseEvt("dblclick",e.target,e.changedTouches[0])}else{e.target.setAttribute("t9dbclick","dbclick");timer=setTimeout(function(){e.target.removeAttribute("t9dbclick")},1000)}e.target.removeAttribute("t9movement")}simMouseEvt("mouseup",e.target,e.changedTouches[0])||e.preventDefault()})},console:{log:window.console&&window.console.log||$.noop,info:window.console&&window.console.info||$.noop,warn:window.console&&window.console.warn||$.noop,error:window.console&&window.console.error||$.noop,assert:window.console&&window.console.assert||$.noop,dir:window.console&&window.console.dir||$.noop,clear:window.console&&window.console.clear||$.noop,profile:window.console&&window.console.profile||$.noop,profileEnd:window.console&&window.console.profileEnd||$.noop},parseJson:function(text){try{return eval("("+text+")")}catch(e){return{}}},browser:{isIE6:$.browser.msie&&/^6./.test($.browser.version),isIE7:$.browser.msie&&/^7./.test($.browser.version)},fx:function(open){$.fx.off=!open},formatJson:function(t,o){if(!o||!t){return}var r={};for(var k in t){var v=t[k];if(v&&v instanceof RegExp){if(o[k]&&v.test(o[k])){o[k]&&(r[k]=o[k])}else{return}}else{if(v&&v instanceof Array){if(!o[k]){continue}r[k]=[];$.each(o[k],function(i,e){r[k].push(T9.formatJson(t,e))});r[k]=$.grep(r[k],function(e,i){return !!e})}else{if(v&&typeof v==="object"){o[k]&&(r[k]=T9.formatJson(v,o[k]))}else{if(v==="*"){r[k]=o[k]}else{if(v==="not"){}else{o[k]&&(r[k]=o[k])}}}}}}return r},components:{},layouts:{register:{}},getCmp:function(id){return T9.components[id]},addCmp:function(id,cmp){if(typeof id=="string"||typeof id=="number"){T9.components[id]=cmp}},removeCmp:function(id){delete T9.components[id]},getAutoID:function(prefix){T9.autoID=T9.autoID||0;T9.autoID++;return(prefix||"t9Auto")+T9.autoID},jsonToString:function(o){var self=this;switch(typeof(o)){case"string":return'"'+o.replace(/(["\\])/g,"\\$1")+'"';case"function":return o;case"array":return"["+o.map(self.jsonToString).join(",")+"]";case"object":if(o instanceof Array){var strArr=[];var len=o.length;for(var i=0;i<len;i++){strArr.push(self.jsonToString(o[i]))}return"["+strArr.join(",")+"]"}else{if(o==null){return"null"}else{var string=[];for(var k in o){string.push(self.jsonToString(k)+":"+self.jsonToString(o[k]))}return"{"+string.join(",")+"}"}}case"number":return o;case false:return o;default:return o}},addPros:function(el,pros){var el=$(el);if(!el[0]||!pros){return false}var tagName=el[0].tagName;var elPros={BODY:["style"],DIV:["style","onclick"],SPAN:["style"],A:["href","style","target","onclick"],IMG:["style","src"]};$.each(pros,function(k,v){if($.inArray(k,elPros[tagName]||[])>=0){el.attr(k,v)}})},compose:function(cmp,subcmp){var o={};subcmp.compose()&&$.each(subcmp.compose(),function(k,v){if(typeof v==="function"){o[k]=function(){v.apply(subcmp,arguments)}}});$.extend(cmp,o)},isCmp:function(o){return !!(T9.register[o&&o.xtype]&&o.status&&o.render)},createComponent:function(){var type=arguments[0],opts=arguments[1]||{},i=2,length=arguments.length;if(length>0){if(typeof name==="string"){this[type]=function(cfg){cfg=cfg||{};cfg.status=cfg.status||{};$.extend(true,this,opts);$.extend(this,cfg);this.initialize();return(this.members&&this.members())||this};for(;i<length;i++){$.extend(this[type].prototype,arguments[i])}}var xtype=type.toLowerCase();this.register[xtype]=this[type];this[type].prototype.xtype=xtype}},packCmp:function(cfg){cfg=cfg||{};cfg.el=$(cfg.el||cfg.html||"<div></div>");cfg.cls&&cfg.el.addClass(cfg.cls);cfg.style&&cfg.el.css(cfg.style);cfg.renderTo&&cfg.el.appendTo(cfg.renderTo);return{el:cfg.el,render:function(el){if(el){cfg.el.appendTo(el)}}}},zIndex:1,maxZIndex:9999,topZIndex:function(layer){T9.zIndex++;return{upper:T9.zIndex+5000,middle:T9.zIndex+3000,lower:T9.zIndex+1000}[layer]||T9.zIndex},error:function(type){if(type=="close"){T9.error.originalEvent=T9.error.originalEvent||window.onerror;window.onerror=function(e,url,line){T9.console.error(url+"  "+line+"  "+e);return true}}else{window.onerror=T9.error.originalEvent}}};T9.createComponent("Component",null,{initialize:function(){this.status.initialized=false;this.el=$(this.el||"<div></div>");this.id=this.id||T9.getAutoID(this.autoIdPrefix);this.el.attr("id",this.id);T9.addCmp(this.id,this);this.doListeners();this.doLoader();this.renderTo&&this.render(this.renderTo);this.cls&&this.el.addClass(this.cls);this.parentCmp&&this.parentCmp.addItems(this);this.initComponent();this.style&&this.el.css(this.style);this.doDraggable();this.doResizable();this.doInitStatus();this.status.initialized=true},doInitStatus:function(){},initComponent:$.noop,reload:function(){this.doLoader();this.refresh()},refresh:function(){this.empty();this.initComponent()},doDraggable:function(){if(this.draggable){if(!this.modal){var mask=$(".draggable-mask");if(!mask.length){mask=$('<div class="draggable-mask"></div>');$("body").append(mask)}this.draggable.start=function(e,ui){mask.css({"z-index":self.zIndex});mask.show()}}this.el.draggable(this.draggable);var self=this;this.el.bind("dragstop",function(){self.left=self.el.css("left");self.top=self.el.css("top");if(!self.modal){mask.hide()}});this.drag={destroy:function(){self.el.draggable("destroy")},disable:function(){self.el.draggable("disable")},enable:function(){self.el.draggable("enable")},option:function(name,value){return self.el.draggable("option",name,value)}};this.status.draggable=true}},doResizable:function(){if(this.resizable){this.el.resizable(this.resizable);var self=this;this.resize={destroy:function(){self.el.resizable("destroy")},disable:function(){self.el.resizable("disable")},enable:function(){self.el.resizable("enable")},option:function(name,value){return self.el.resizable("option",name,value)}};this.status.resizable=true}},doListeners:function(){if(this.listeners){var self=this;$.each(this.listeners,function(k,v){if(typeof v==="function"){T9.Event.add(self,"bind",k,false,v)}else{if(typeof v==="object"){$.each(v,function(key,value){T9.Event.add(self,"bind",k,key,value)})}}})}},empty:function(){this.el.empty()},destroy:function(){if(this.items){var items=this.items.slice();$.each(items,function(i,e){e&&e.destroy&&e.destroy()})}if(this.parentCmp){this.parentCmp.removeItem(this,true)}this.el.empty();this.el.remove();T9.removeCmp(this.id)},hide:function(speed,callback){if(this.status.hidden){return}this.hideEffect.call(this,speed,callback);this.status.hidden=true},hideEffect:function(speed,callback){this.el.hide(speed);callback&&callback()},addClass:function(){this.el.addClass.apply(this.el,arguments)},removeClass:function(){this.el.removeClass.apply(this.el,arguments)},changeStyle:function(cls){this.addClass(cls)},show:function(){if(this.status.hidden){this.status.hidden=false;this.showEffect.apply(this,arguments)}},showEffect:function(){this.el.show.apply(this.el,arguments)},setPosition:function(pos){this.el.offset(pos)},fadeIn:function(){this.el.fadeIn.apply(this.el,arguments)},fadeOut:function(speed){this.el.fadeOut.apply(this.el,arguments)},render:function(el){if(el){this.el.appendTo(el);this.parentEl=el}},getId:function(){return this.id},setId:function(id){T9.removeCmp(this.id);this.id=id;T9.addCmp(this.id,this)},getWidth:function(){return this.width},getHeight:function(){return this.height},getAbsHeight:function(){return this.el.height()+"px"},getAbsWidth:function(){return this.el.width()+"px"},getPosX:function(){return this.el.position().left},getPosY:function(){return this.el.position().top},setStyle:function(style){this.el.css(style)},doLoader:function(){if(!this.loader||typeof this.loader!=="object"){return}var o;this.loader.param={totalRecords:this.maxRecords||0};if(this.loader.xtype==="loader"){o=this.loader.load()}else{var loader=new T9.Loader(this.loader);o=loader.load()}this.data=o&&o.data;this.pageInfo=o&&o.pageInfo},getParentEl:function(flag){if(flag){return this.el.parent()}return this.parentEl||this.el.parent()[0]?this.el.parent():$("body")},getEvtActor:function(){return this.evtActor||this.el},setEvtActor:function(e){this.evtActor=e},members:$.noop,compose:$.noop});T9.Loader=function(cfg){var opts={url:"",dataType:"json",type:"POST",param:{},dataRender:null,success:null,async:false,error:null};$.extend(true,this,opts,cfg);this.initialize()};$.extend(T9.Loader.prototype,{initialize:function(){},load:function(){var t=this;var dataType=this.dataType;if(this.dataType.toLowerCase()=="json"){dataType="text"}var data;$.ajax({type:t.type,url:t.url,async:t.async,dataType:dataType,data:t.param,success:function(text){if(t.dataType.toLowerCase()=="json"){data=(t.dataRender||(function(data){if(data.rtState=="0"){data=data.rtData}else{console.info(data.rtMsrg)}return data}))(T9.parseJson(text))}t.success&&t.success(data)},error:t.error});return{data:data}}});T9.Plugins={};T9.Event={add:function(cmp,type,name,moment,event,scope,params){if(cmp.getEvtActor&&((cmp[name]&&(moment==="before"||moment==="after"))||!moment)){var evtName=name+(moment||"");if(type=="bind"){cmp.getEvtActor().bind(evtName,{cmp:cmp,params:params},function(e){var args=Array.prototype.slice.call(arguments,0);args.push(e.data.cmp,e.data.params);event.apply(scope||cmp,args)})}else{if(type=="one"){cmp.getEvtActor().one(evtName,{cmp:cmp,params:params},function(e){event.call(scope||cmp,args)})}}if(moment==="before"||moment==="after"){if(cmp[name]&&!cmp[name].original){var tmp=cmp[name];cmp[name]=function(){cmp.getEvtActor().trigger(name+"before");cmp[name].original.apply(cmp,arguments);cmp.getEvtActor().trigger(name+"after")};cmp[name].original=tmp}}}},del:function(cmp,name,moment){if(cmp.getEvtActor&&(cmp[name]&&(moment==="before"||moment==="after")||!moment)){var evtName=name+(moment||"");cmp.getEvtActor().unbind(evtName)}}};T9.Tools={toggle:{defaultHandler:function(event,toolEl,panel,params){panel.toggle()}},close:{title:"关闭",defaultHandler:function(event,toolEl,panel,params){panel.close()}},minimize:{title:"最小化",defaultHandler:function(event,toolEl,panel,params){panel.minimize()}},maximize:{title:"全屏最大化",defaultHandler:function(event,toolEl,panel,params){panel.tools.restore&&panel.tools.restore.show();panel.tools.plus&&panel.tools.plus.show();toolEl.hide();panel.maximize()}},restore:{title:"还原",defaultHandler:function(event,toolEl,panel,params){panel.tools.maximize&&panel.tools.maximize.show();panel.tools.plus&&panel.tools.plus.show();toolEl.hide();panel.restore()}},gear:{defaultHandler:function(event,toolEl,panel,params){}},pin:{title:"置顶",defaultHandler:function(event,toolEl,panel,params){panel.tools.pin&&panel.tools.pin.hide();panel.tools.unpin&&panel.tools.unpin.show();panel.pin()}},unpin:{title:"浮动",defaultHandler:function(event,toolEl,panel,params){panel.tools.pin&&panel.tools.pin.show();panel.tools.unpin&&panel.tools.unpin.hide();panel.unpin()}},right:{defaultHandler:function(event,toolEl,panel,params){}},left:{defaultHandler:function(event,toolEl,panel,params){}},up:{defaultHandler:function(event,toolEl,panel,params){}},down:{defaultHandler:function(event,toolEl,panel,params){}},refresh:{title:"刷新",defaultHandler:function(event,toolEl,panel,params){panel.refresh();panel.status.hidden&&panel.show()}},minus:{defaultHandler:function(event,toolEl,panel,params){}},plus:{title:"工作区最大化",defaultHandler:function(event,toolEl,panel,params){panel.tools.restore&&panel.tools.restore.show();panel.tools.maximize&&panel.tools.maximize.show();toolEl.hide();panel.maximize("parent")}},help:{defaultHandler:function(event,toolEl,panel,params){}},search:{defaultHandler:function(event,toolEl,panel,params){}},save:{defaultHandler:function(event,toolEl,panel,params){}},more:{title:"更多",defaultHandler:function(event,toolEl,panel,params){}}};if(T9.isTouchDevice){T9.fitTouchDevice()}function parseFeatures(features){if(!features){return}var cfg={};var pros=features.split(/[,;]/);for(var i=0;i<pros.length;i++){if(pros[i]){var kv=pros[i].split(/[=:]/);if(kv.length>1){var key={dialogheight:"height",dialogwidth:"width",height:"height",width:"width",resizable:"resizable"}[kv[0].toLowerCase()];if(key){cfg[key]=kv[1]}}}}return cfg}if(top==window&&T9.isTouchDevice){window.showModalDialog=function(url,args,features){var win;var cfg={src:url,cls:"",layer:"upper",modal:true,draggable:{containment:false},listeners:{doContainer:{after:function(e,t){try{var i=t.container.iframeDom;var w=i.contentWindow;w.dialogArguments=args;var id=t.getId();i.onload=function(){w.dialogArguments=w.dialogArguments||args;try{var s=w.document.createElement("script");s.innerHTML="function close() {parent.T9.getCmp('"+id+"').close();}";var head=w.document.getElementsByTagName("head").item(0);s.setAttribute("type","text/javascript");head.appendChild(s)}catch(e){w.close=function(){t.close()}}finally{}}}catch(e){}finally{}}}}};$.extend(true,cfg,parseFeatures(features));win=new T9.Window(cfg);win.show()};window.open=function(url,name,features,replace){var self=this;var cfg={src:url,title:name,width:800,height:600,layer:"upper",draggable:{containment:false},resizable:{},listeners:{doContainer:{after:function(e,t){try{var i=t.container.iframeDom;var w=i.contentWindow;w.opener=self;var id=t.getId();i.onload=function(){try{w.opener=w.opener||self;var s=w.document.createElement("script");s.innerHTML="function close() {parent.T9.getCmp('"+id+"').close();}";var head=w.document.getElementsByTagName("head").item(0);s.setAttribute("type","text/javascript");head.appendChild(s)}catch(e){try{w.close=function(){t.close()}}catch(e){d.d;T9.console.info(e)}finally{}}finally{}}}catch(e){}finally{}}}}};$.extend(true,cfg,parseFeatures(features));var win=new T9.Window(cfg);win.show()}}else{if(T9.isTouchDevice){window.showModalDialog=function(){top.T9&&top.showModalDialog.apply(this,arguments)};window.open=function(){top.T9&&top.open.apply(this,arguments)}}}})(jQuery);(function($){var autoOpts={el:$("<div></div>"),items:[],cmpCls:"jq-autolayout"};T9.createComponent.call(T9.layouts,"AutoLayout",autoOpts,{initialize:function(){this.el.addClass(this.cmpCls);this.initComponent();this.style&&this.el.css(this.style)},initComponent:function(){this.renderItems();var self=this;$.each(this.items,function(i,e){self.doItem(e)})},doDroppable:function(item){if(this.droppable){if(item){var self=this;item.contentEl.droppable(this.droppable);item.contentEl.addClass(this.droppableCls);item.setEvtActor(item.contentEl);T9.Event.del(item,"drop");T9.Event.add(item,"bind","drop",null,function(evt,ui,t){if(ui.draggable.filter(self.droppable.accept)[0]){self.droppable.dropStop&&self.droppable.dropStop(evt,ui,t)}})}var drop=this.droppable.drop;this.droppable.drop=null;var self=this;$.each(this.droppableCmps,function(i,e){e.contentEl.droppable(self.droppable);e.contentEl.addClass(self.droppableCls);e.setEvtActor(e.contentEl);T9.Event.add(e,"bind","drop",null,function(evt,ui,t){if(ui.draggable.filter(self.droppable.accept)[0]){drop&&drop(evt,ui,t)}})})}},doSortable:function(){if(!this.sortable){return}var self=this;var cfg={start:function(e,ui){if(/%/.test(ui.item.css("width"))){ui.item.data("sortWidth",ui.item.css("width"));ui.item.css({width:ui.placeholder.innerWidth()});ui.placeholder.css({height:ui.item.innerHeight()});ui.item.addClass("ui-draggable-dragging")}},stop:function(e,ui){if(ui.item.data("sortWidth")){ui.item.removeData("sortWidth");ui.item.css({width:ui.item.data("sortWidth")});ui.item.removeClass("ui-draggable-dragging")}self.listeners&&self.listeners.sortStop&&self.listeners.sortStop(e,ui)},containment:self.el,handle:".drag-handle"};$.extend(cfg,self.sortable);$.each(this.sortableCmps,function(i,e){e.contentEl.addClass(self.sortableCls)});if(self.sortConnect){cfg.connectWith=self.el.find("."+self.sortableCls)}this.el.find("."+this.sortableCls).sortable(cfg);$.each(this.sortableCmps,function(i,e){e.setEvtActor(e.contentEl);T9.Event.add(e,"bind","sortremove",null,function(e,ui,cmp){cmp.removeItem(T9.getCmp(ui.item.attr("id")),true)});T9.Event.add(e,"bind","sortreceive",null,function(e,ui,cmp){cmp.receiveItem(T9.getCmp(ui.item.attr("id")))});e.el.css({overflow:"visible"})});self.el.css({"overflow-y":"hidden","overflow-x":"hidden"})},doItem:function(e){if(T9.isCmp(e)){e.setStyle({width:"100%"})}},addItems:function(items){if(items instanceof Array){var self=this;$.each(items,function(i,e){self.addItems(e)})}else{items=this.renderItem(items);this.doItem(items);this.items.push(items)}},removeItems:function(){var temp=this.items.slice();$.each(temp,function(i,e){if(T9.isCmp(e)){e.destroy()}else{if(e.el){e.el.remove()}}});this.items.splice(0)},renderItems:function(items){var self=this;if(items instanceof Array){this.removeItems()}else{items=this.items}if($.isArray(this.items)&&!this.status.renderItems){$.each(items,function(i,e){self.items[i]=self.renderItem(e)});this.status.renderItems=true}},renderItem:function(item,renderTo){if(!item){return}if(!T9.isCmp(item)&&!item.render){if(!item.xtype&&item.constructor==Object){item.xtype="container"}if(typeof item.xtype==="string"){item=new T9.register[item.xtype](item)}}if(T9.isCmp(item)){item.render(renderTo||this.el);item.parentCmp=this.owner}else{if(item.render){item.render(renderTo||this.el)}else{item.parentCmp=this.owner}}this.doItem(item);return item},receiveItem:function(item){item.parentCmp=this.owner;item.parentEl=this.el;this.items.push(item)},removeItem:function(item,flag){var self=this;if(typeof item==="number"){item=this.items[item];this.items.splice(item,1)}else{$.each(this.items,function(i,e){if(e==item){self.items.splice(i,1)}})}if(!flag){if(T9.isCmp(item)){item.destroy()}else{if(item.el){item.el.remove()}}}},sortItems:function(deep){$.each(this.items,function(i,e){e.sort=e.parentEl&&e.parentEl.children().index(this.el)||0;deep&&e.items&&e.sortItems&&e.sortItems(deep)});this.items.sort(function(a,b){return a.sort-b.sort})},designLayout:function(flag){if(flag===false){}else{this.designMode=true;this.doDesign()}},doDesign:$.noop,compose:function(){var self=this;return{addItems:self.addItems,renderItems:self.renderItems,renderItem:self.renderItem,removeItem:self.removeItem,receiveItem:self.receiveItem,sortItems:self.sortItems,removeItems:self.removeItems,designLayout:self.designLayout}}})})(jQuery);(function($){var opts={el:$("<div></div>"),activeItem:0,tabs:false,lazyLoad:false,fit:true,loadHandler:[],sp:"&nbsp;|&nbsp;"};T9.createComponent.call(T9.layouts,"CardLayout",opts,T9.layouts.AutoLayout.prototype,{initComponent:function(){var self=this;var activeItem=this.activeItem||0;this.lastActive=this.activeItem;var lazyLoad=this.lazyLoad;var reload=this.reload;this.loadHandler=this.loadHandler||[];var loadHandler=this.loadHandler;if(this.items&&this.items.length){this.renderItems();$.each(this.items,function(i,e){e.setStyle({width:"100%"});if(self.fit){e.setStyle({height:"100%"})}if(activeItem!=i){e.hide()}else{if(lazyLoad){if(loadHandler[i]){loadHandler[i](e,i);eloaded=true}}}if(!lazyLoad){if(loadHandler[i]){loadHandler[i](e,i)}}})}else{$.each(this.el.children(),function(i,e){$(e).css({width:"100%",height:"100%"});if(activeItem!=i){$(e).hide()}else{if(lazyLoad){if(loadHandler[i]){loadHandler[i]($(e),i);$(e).data("loaded",true)}}}if(!lazyLoad){if(loadHandler[i]){loadHandler[i]($(e),i)}}})}this.doTabs()},doTabs:function(){if(this.tabs){var self=this;var tabHeader=new T9.Container({layout:"floatlayout",height:"auto",cls:"tab-header",items:[]});if(self.owner.owner){self.owner.owner.tabHeader=tabHeader;self.owner.owner.contentEl.before(tabHeader.el)}else{self.owner.owner.tabHeader=tabHeader;self.owner.el.prepend(tabHeader.el)}if(this.items&&this.items.length){$.each(this.items,function(i,e){if(e.tabBtn){if(self.activeItem==i){e.tabBtn.status=e.tabBtn.status||{};e.tabBtn.status.isPressed=true}e.tabBtn.style=e.tabBtn.style||{};e.tabBtn.style["float"]="left";e.tabBtn.style.width="auto";e.tabBtn.handler=function(){if(self.items[self.lastActive].tabBtn){tabHeader.items[self.lastActive].setStatus("default")}if(self.items[i].tabBtn){tabHeader.items[i].setStatus("active")}self.setActiveItem(i)};tabHeader.addItems(self.items[i].tabBtn)}else{var a=$('<a href="javascript:void(0)"></a>');a.html(e.title||("tab"+i));a.click(function(){self.setActiveItem(i)});tabHeader.el.append(a)}})}}},setActiveItem:function(i){this.el.children().eq(this.lastActive).hide();this.el.children().eq(i).show();this.lastActive=i;var el=this.el.children().eq(i);if(this.lazyLoad&&this.reload){if(this.loadHandler[i]){this.loadHandler[i](el,i)}}else{if(this.lazyLoad){if(this.loadHandler[i]&&!el.data("loaded")){this.loadHandler[i](el,i);el.data("loaded",true)}}}}})})(jQuery);(function($){var opts={el:$("<div></div>"),items:[],draggable:{containment:"parent"},resizable:{},position:"center",droppableCls:"free-droppable",cmpCls:"jq-freelayout",droppableCmps:[]};T9.createComponent.call(T9.layouts,"FitLayout",opts,T9.layouts.AutoLayout.prototype,{doItem:function(e){if(T9.isCmp(e)){e.setStyle({width:"100%",zoom:1});if(e.setHeight){e.setHeight(this.el.height()-(e.weltHeight||75))}}},receiveItem:function(e){T9.layouts.AutoLayout.prototype.receiveItem.apply(this,arguments);if(e.setHeight){e.setHeight(this.el.height()-(e.weltHeight||75))}}})})(jQuery);(function($){var opts={el:$("<div></div>"),border:"5px solid transparent",items:[],sortable:{revert:true,tolerance:"pointer"},pixel:false,designMode:false,cellpadding:0,cellspacing:0,cmpCls:"jq-columnlayout",sortableCls:"column-sortable",droppableCls:"column-droppable",droppableCmps:[],sortableCmps:[],style:{position:"relative","overflow-y":"auto","overflow-x":"hidden"}};T9.createComponent.call(T9.layouts,"ColumnLayout",opts,T9.layouts.AutoLayout.prototype,{initComponent:function(){this.table=$("<table></table>");this.table.attr("cellpadding",this.cellpadding);this.table.attr("cellspacing",this.cellspacing);this.el.append(this.table);this.renderCells();this.doSortable()},renderCells:function(){var self=this;var tr=$("<tr></tr>");this.table.append(tr);$.each(this.items,function(i,e){var td=$('<td valign="top"></td>');var width;if(self.pixel){if(e.columnWidth){width=parseInt(e.columnWidth)+"px"}else{width="auto"}}else{width=Math.floor((e.columnWidth||0.5)*100)+"%"}td.css({width:width});self.items[i]=e=self.renderItem(e,td);tr.append(td)});this.doDesign()},doDesign:function(){if(this.designMode){var self=this;var dragColumns=this.table[0].rows[0].cells;if(!dragColumns){return}var dragColumnNo;var dragX;var saveOnmouseup;var saveOnmousemove;var saveBodyCursor;function preventEvent(e){var ev=e||window.event;if(ev.preventDefault){ev.preventDefault()}else{ev.returnValue=false}if(ev.stopPropagation){ev.stopPropagation()}return false}this.changeColumnWidth=function(no,w){if(!dragColumns){return false}if(no<0){return false}if(dragColumns.length<no){return false}if(parseInt(dragColumns[no].style.width)<=-w){return false}if(dragColumns[no+1]&&parseInt(dragColumns[no+1].style.width)<=w){return false}var width=parseInt(dragColumns[no].style.width)+w+"px";dragColumns[no].style.width=width;if(dragColumns[no+1]){dragColumns[no+1].style.width=parseInt(dragColumns[no+1].style.width)-w+"px"}return true};this.columnDrag=function(e){var e=e||window.event;var X=e.clientX||e.pageX;if(!self.changeColumnWidth(dragColumnNo,X-dragX)){self.stopColumnDrag(e)}dragX=X;preventEvent(e);return false};this.stopColumnDrag=function(e){var e=e||window.event;if(!dragColumns){return}document.onmouseup=saveOnmouseup;document.onmousemove=saveOnmousemove;document.body.style.cursor=saveBodyCursor;var colWidth="";var separator="";for(var i=0;i<dragColumns.length;i++){colWidth+=separator+parseInt($(dragColumns[i]).width());separator="+";self.items[i].columnWidth=Math.floor($(dragColumns[i]).width()*100/self.table.width())/100}preventEvent(e)};this.startColumnDrag=function(e){var e=e||window.event;dragColumnNo=(e.target||e.srcElement).parentNode.cellIndex;dragX=e.clientX||e.pageX;var colWidth=new Array();for(var i=0;i<dragColumns.length;i++){colWidth[i]=parseInt($(dragColumns[i]).width())}for(var i=0;i<dragColumns.length;i++){dragColumns[i].width="";dragColumns[i].style.width=colWidth[i]+"px"}saveOnmouseup=document.onmouseup;document.onmouseup=self.stopColumnDrag;saveBodyCursor=document.body.style.cursor;document.body.style.cursor="w-resize";saveOnmousemove=document.onmousemove;document.onmousemove=self.columnDrag;preventEvent(e)};for(var i=0;i<dragColumns.length;i++){var evt=$("<div></div>");evt.css({position:"relative",height:"20px","background-color":"gray",width:"5px",left:"100%","z-index":T9.topZIndex(),cursor:"w-resize"});$(dragColumns[i]).prepend(evt);evt.mousedown(self.startColumnDrag)}}},doItem:function(e){e.setColumnWidth=function(width){e.parentEl.css({width:Math.floor((width||0.5)*100)+"%"})};e.leaf=true;if(T9.isCmp(e)){if(this.sortable){e.contentEl.css({"padding-bottom":"100px"})}this.doDroppable(e);this.sortable&&this.sortableCmps.push(e)}}})})(jQuery);(function($){var opts={el:$("<div></div>"),items:[],"float":"left",droppableCls:"float-droppable",cmpCls:"jq-floatlayout"};T9.createComponent.call(T9.layouts,"FloatLayout",opts,T9.layouts.AutoLayout.prototype,{initComponent:function(){this.el=$(this.el);this.el.parent().css({width:"auto"});this.doFloat()},doFloat:function(){var self=this;if(this.items instanceof Array&&this.items.length){$.each(this.items,function(i,e){self.items[i]=e=self.renderItem(e)})}else{this.el.children().css({"float":self["float"]})}},doItem:function(e){if(T9.isCmp(e)){e.setStyle({"float":this["float"]});this.droppable&&this.droppableCmps.push(e)}else{e.el.css({"float":this["float"]})}}})})(jQuery);(function($){var opts={el:$("<div></div>"),items:[],draggable:{containment:"parent"},resizable:{},position:"center",droppableCls:"free-droppable",cmpCls:"jq-freelayout",droppableCmps:[]};T9.createComponent.call(T9.layouts,"FreeLayout",opts,T9.layouts.AutoLayout.prototype,{initComponent:function(){this.el=$(this.el);if(this.droppable){this.el.data("cmp",this.owner);this.el.addClass(this.droppableCls)}var self=this;$.each(this.items,function(i,e){self.items[i]=e=self.renderItem(e,i);self.doItem(e)});this.doDroppable(this.owner)},doDraggable:function(draggable){$.extend(true,this.draggable,draggable);var self=this;if(!this.draggable){return}if(this.items instanceof Array&&this.items.length){$.each(this.items,function(i,e){self.doItemDrag(e)})}else{this.el.children().draggable(this.draggable)}},doResizable:function(resizable){$.extend(true,this.resizable,resizable);var self=this;if(!this.resizable){return}if(this.items instanceof Array&&this.items.length){$.each(this.items,function(i,e){self.doItemResize(e)})}else{this.el.children().resizable(this.resizable)}},doItemResize:function(e){if(T9.isCmp(e)){if(!e.status.resizable){e.resizable={};$.extend(true,e.resizable,this.resizable);e.doResizable&&e.doResizable()}}},doItemDrag:function(e){if(T9.isCmp(e)){if(!e.draggable){e.draggable={};$.extend(true,e.draggable,this.draggable);e.doDraggable&&e.doDraggable()}else{if(e.drag){e.drag.option("containment","parent")}}if(!e.left&&!e.top){if(self.position=="center"){e.setPosCenter()}}if(!e.status.clickActive){e.clickActive&&e.clickActive()}e.setStyle({left:e.left,top:e.top})}},doItem:function(e){this.doItemDrag(e);this.doItemResize(e);if(T9.isCmp(e)){e.setStyle({position:"absolute"})}}})})(jQuery);(function($){var opts={el:$("<div></div>"),border:"5px solid transparent",items:[],sortable:{revert:true,tolerance:"pointer"},cols:3,cellpadding:0,cellspacing:0,designMode:false,selectable:{cancel:".gridlayout-dragColumn,.extend-container,."+this.designCls},designCls:"gridlayout-dragColumn",cmpCls:"jq-gridlayout",selectableCls:"ui-selected",sortableCls:"grid-sortable",droppableCls:"grid-droppable",droppableCmps:[],sortableCmps:[],colsWidth:[]};T9.createComponent.call(T9.layouts,"GridLayout",opts,T9.layouts.ColumnLayout.prototype,{initComponent:function(){T9.layouts.ColumnLayout.prototype.initComponent.call(this)},initTable:function(){this.tr=[];for(var i=0;i<this.cols;i++){var tr=$("<tr></tr>");this.tr.push(tr);this.table.append(tr);for(var j=0;j<this.rows;j++){var td=$("<td></td>");tr.append(td)}}},renderCells:function(){var self=this;this.tr=[];var cols=0;var colIndex=0;var rowIndex=0;this.tr.push({cols:this.cols,td:[]});$.each(this.items,function(i,e){e.colSpan=e.colSpan||1;e.rowSpan=e.rowSpan||1;e.index=i;e.colIndex=colIndex%self.cols;colIndex+=e.colSpan;while(colIndex>self.tr[rowIndex].cols){rowIndex++;if(!self.tr[rowIndex]){self.tr.push({cols:self.cols,td:[]})}colIndex=e.colSpan}e.rowIndex=rowIndex;if(e.rowSpan>1){for(var j=1;j<e.rowSpan;j++){if(!self.tr[rowIndex+j]){self.tr.push({cols:self.cols-e.colSpan,td:[]})}else{self.tr[rowIndex+j].cols-=e.colSpan}}}self.tr[rowIndex].td.push(e);self.doItem(e)});var tr=$("<tr></tr>");tr.addClass(this.designCls);for(var i=0;i<this.cols;i++){var td=$("<td></td>");td.attr("width",self.colsWidth[i]||"");tr.append(td)}this.table.prepend(tr);this.renderTable();this.doDesign()},renderTable:function(){var self=this;$.each(this.tr,function(i,e){var tr=$("<tr></tr>");self.table.append(tr);$.each(e.td,function(j,el){var td=$("<td></td>");td.attr("valign","top");td.attr("colSpan",el.colSpan);td.attr("rowSpan",el.rowSpan);tr.append(td);el.layout="fitlayout";el.height=el.rowSpan*100;self.items[el.index]=el=self.renderItem(el,td);td.data("cmpId",el.id)})})},doItem:function(e){if(T9.isCmp(e)){e.leaf=true;this.sortable&&this.sortableCmps.push(e);this.doDroppable(e)}},doDesign:function(){if(this.designMode){this.doSortable();this.table.selectable(this.selectable);this.el.addClass("gridlayout-designMode");this.doTipMenu();var self=this;var dragColumns=this.table[0].rows[0].cells;if(!dragColumns){return}var dragColumnNo;var dragX;var saveOnmouseup;var saveOnmousemove;var saveBodyCursor;function preventEvent(e){var ev=e||window.event;if(ev.preventDefault){ev.preventDefault()}else{ev.returnValue=false}if(ev.stopPropagation){ev.stopPropagation()}return false}this.changeColumnWidth=function(no,w){if(!dragColumns){return false}if(no<0){return false}if(dragColumns.length<no){return false}if(parseInt(dragColumns[no].style.width)<=-w){return false}if(dragColumns[no+1]&&parseInt(dragColumns[no+1].style.width)<=w){return false}var width=parseInt(dragColumns[no].style.width)+w+"px";dragColumns[no].style.width=width;self.colsWidth[no]=width;if(dragColumns[no+1]){self.colsWidth[no+1]=parseInt(dragColumns[no+1].style.width)-w+"px";dragColumns[no+1].style.width=parseInt(dragColumns[no+1].style.width)-w+"px"}return true};this.columnDrag=function(e){var e=e||window.event;var X=e.clientX||e.pageX;if(!self.changeColumnWidth(dragColumnNo,X-dragX)){self.stopColumnDrag(e)}dragX=X;preventEvent(e);return false};this.stopColumnDrag=function(e){var e=e||window.event;if(!dragColumns){return}document.onmouseup=saveOnmouseup;document.onmousemove=saveOnmousemove;document.body.style.cursor=saveBodyCursor;var colWidth="";var separator="";for(var i=0;i<dragColumns.length;i++){colWidth+=separator+parseInt($(dragColumns[i]).width());separator="+"}preventEvent(e)};this.startColumnDrag=function(e){var e=e||window.event;dragColumnNo=(e.target||e.srcElement).parentNode.cellIndex;dragX=e.clientX||e.pageX;var colWidth=new Array();for(var i=0;i<dragColumns.length;i++){colWidth[i]=parseInt($(dragColumns[i]).width())}for(var i=0;i<dragColumns.length;i++){dragColumns[i].width="";dragColumns[i].style.width=colWidth[i]+"px"}saveOnmouseup=document.onmouseup;document.onmouseup=self.stopColumnDrag;saveBodyCursor=document.body.style.cursor;document.body.style.cursor="w-resize";saveOnmousemove=document.onmousemove;document.onmousemove=self.columnDrag;preventEvent(e)};for(var i=0;i<dragColumns.length;i++){var evt=$("<div></div>");evt.css({position:"relative",height:"20px","background-color":"gray",width:"5px",left:"100%","z-index":T9.topZIndex(),cursor:"w-resize"});$(dragColumns[i]).empty().append(evt);evt.mousedown(self.startColumnDrag)}}},verifyMerge:function(){var self=this;var cls="."+this.selectableCls;var cells=0;var tds=self.table.find("td"+cls);if(tds.length<2){return false}var td=tds.first();var cmp=T9.getCmp(td.data("cmpId"));var top=cmp.rowIndex,left=cmp.colIndex,bottom=cmp.rowIndex+cmp.rowSpan,right=cmp.colIndex+cmp.colSpan;self.table.find("td"+cls).each(function(i,e){var cmp=T9.getCmp($(e).data("cmpId"));left=Math.min(left,cmp.colIndex);top=Math.min(top,cmp.rowIndex);right=Math.max(right,(cmp.colIndex+cmp.colSpan));bottom=Math.max(bottom,(cmp.rowIndex+cmp.rowSpan));var col=e.colSpan||0;var row=e.rowSpan||0;cells+=col*row;return;var rowIndex=e.parentNode.rowIndex;var cellIndex=e.cellIndex;if(rowIndex<top){top=rowIndex}if(rowIndex+row>bottom){bottom=rowIndex+row}if(cellIndex<left){left=cellIndex}if(cellIndex+col>right){right=cellIndex+col}});if(cells!=(right-left)*(bottom-top)){return false}return true},mergeCells:function(){if(!this.verifyMerge()){return}var self=this;var cls="."+this.selectableCls;var cols=0,rows=0,total=0;self.table.find("td"+cls).eq(0).parent().children(cls).each(function(i,e){cols+=$(e).attr("colspan")||0});self.table.find("td"+cls).each(function(i,e){var col=$(e).attr("colspan")||0;var row=$(e).attr("rowspan")||0;total+=col*row});rows=total/cols;var td=$("td"+cls).first();self.table.find("td"+cls).each(function(i,e){if(i==0){$(e).attr("colspan",cols);$(e).attr("rowspan",rows);var cmp=T9.getCmp($(e).find("div:first").attr("id"));if(cmp){cmp.colSpan=cols;cmp.rowSpan=rows;cmp.setStyle({height:rows*(100+self.cellpadding+self.cellspacing)})}}else{var cmp=T9.getCmp($(e).find("div:first").attr("id"));cmp&&cmp.destroy();$(e).remove()}})},addItem:function(renderTo){renderTo=$(renderTo);var item=new T9.Container({renderTo:renderTo,autoIdPrefix:"portal",layout:"fitlayout",parentCmp:this,style:{height:"100px"}});this.items.push(item);this.doItem(item)},splitCells:function(){var cls="."+this.selectableCls;var cols=0,rows=0,total=0;var self=this;$("td"+cls).eq(0).parent().children(cls).each(function(i,e){cols+=$(e).attr("colspan")||0});$("td"+cls).each(function(i,e){var col=$(e).attr("colspan")||0;$(e).attr("colspan",1);var cmp=T9.getCmp($(e).find("div:first").attr("id"));if(cmp){cmp.colSpan=1}for(;col>1;col--){var copy=$(e).clone(true).empty();$(e).after(copy);self.addItem(copy)}});$("td"+cls).each(function(i,e){var row=$(e).attr("rowspan")||0;$(e).attr("rowspan",1);var cmp=T9.getCmp($(e).find("div:first").attr("id"));if(cmp){cmp.rowSpan=1}var tr=$(e).parent();for(;row>1;row--){var copy=$(e).clone().empty();tr=tr.next().append(copy);self.addItem(copy)}});if(self.sortable){self.table.find("td").sortable(this.sortable)}this.sortItems();this.refresh()},unselect:function(){this.table.find("."+this.selectableCls).removeClass(this.selectableCls)},sortItems:function(deep){var self=this;$.each(this.items,function(i,e){var r=e.parentEl.parent().index();var c=e.parentEl.index();e.sort=(r+1)*self.cols+c;deep&&e.items&&e.sortItems&&e.sortItems(deep)});this.items.sort(function(a,b){return a.sort-b.sort})},doSortable:function(){if(!this.sortable||!this.designMode){return}var self=this;var cfg={start:function(e,ui){if(/%/.test(ui.item.css("width"))){ui.item.data("sortWidth",ui.item.css("width"));ui.item.css({width:ui.placeholder.innerWidth()});ui.placeholder.css({height:ui.item.innerHeight()});ui.item.addClass("ui-draggable-dragging")}},stop:function(e,ui){if(ui.item.data("sortWidth")){ui.item.removeData("sortWidth");ui.item.css({width:ui.item.data("sortWidth")});ui.item.removeClass("ui-draggable-dragging")}self.listeners&&self.listeners.sortStop&&self.listeners.sortStop(e,ui)},handle:".drag-handle"};$.extend(cfg,self.sortable);$.each(this.sortableCmps,function(i,e){e.contentEl.addClass(self.sortableCls)});if(self.sortConnect){cfg.connectWith=self.el.find("."+self.sortableCls)}this.el.find("."+this.sortableCls).sortable("destroy");this.el.find("."+this.sortableCls).sortable(cfg);$.each(this.sortableCmps,function(i,e){e.setEvtActor(e.contentEl);T9.Event.add(e,"bind","sortremove",null,function(e,ui,cmp){cmp.removeItem(T9.getCmp(ui.item.attr("id")),true)});T9.Event.add(e,"bind","sortreceive",null,function(e,ui,cmp){cmp.receiveItem(T9.getCmp(ui.item.attr("id")))});e.el.css({overflow:"visible"})})},addRow:function(position){var cls="."+this.selectableCls;var self=this;position=position||"after";var clone;if(typeof position==="string"){cls=cls||".ui-selected";var td=$("td"+cls).first();if(!td[0]){return}var tr=td.parent();clone=$("<tr></tr>");for(var i=0;i<this.cols;i++){var td=$("<td></td>");clone.append(td)}if(position=="before"){tr.before(clone)}else{tr.after(clone)}this.doDesign()}clone.children().each(function(i,e){self.addItem(e)});this.sortItems();this.refresh()},addColumn:function(pos){var self=this;this.table.find("tr").each(function(i,e){var td=$('<td valign="top"></td>');if(pos=="right"){td.appendTo(e)}else{td.prependTo(e)}if(!$(this).is("."+self.designCls)){self.addItem(td)}});this.cols++;this.owner.layoutCfg.cols=this.cols;this.sortItems();this.refresh()},doTipMenu:function(){if(this.tip){return}var self=this;var menu=new T9.Menu({classes:["menu-lv3"],data:[{text:"合并单元格",handleClick:function(node,t){self.mergeCells();self.tip.hide()}},{text:"之前加入行",handleClick:function(node,t){self.addRow("before");self.tip.hide()}},{text:"之后加入行",handleClick:function(node,t){self.addRow("after");self.tip.hide()}},{text:"左边插入列",handleClick:function(node,t){self.addColumn();self.tip.hide()}},{text:"右边插入列",handleClick:function(node,t){self.addColumn("right");self.tip.hide()}},{text:"取消选择",handleClick:function(node,t){self.unselect();self.tip.hide()}}],selClass:"menu-selected",renderTo:"body"});this.tip=new T9.Tip({event:"rightClick",delay:2,style:{width:"190px"},items:[menu],listeners:{show:{before:function(e,t){if(!self.verifyMerge()){t.items[0]&&t.items[0].items[0].hide()}else{t.items[0]&&t.items[0].items[0].show()}}}},target:self.el})},refresh:function(){this.el.empty();this.initComponent()}})})(jQuery);(function($){var opts={layout:"autolayout",location:false,layoutCfg:{},items:[],height:"100%",width:"100%",iframeSrc:null,plugins:[],contentEl:null};T9.createComponent("Container",opts,T9.Component.prototype,{initComponent:function(){this.locate();this.el.css({width:this.width,height:this.height,overflow:"hidden"});if(this.contentEl){this.contentEl=$(this.contentEl).show()}else{this.contentEl=$('<div class="jq-container"></div>')}this.el.append(this.contentEl);if(this.html){this.contentEl.html(this.html)}else{if(this.url){this.autoLoad()}else{if(this.iframeSrc){this.loadIframe()}else{if(this.items){this.doLayout()}}}}this.doPlugins()},autoLoad:function(){if(this.contentEl[0]){new Ajax.Updater(this.contentEl[0],this.url,{parameters:this.param,evalScripts:true})}},locate:function(){if(this.location&&$.browser.msie&&/[7,6]/.test($.browser.version)){function parseNumber(n){n=parseInt(n);return isNaN(n)?false:n}this.el.css({position:"absolute"});(typeof this.location=="object")||(this.location={});var op=this.el.offsetParent();this.location.top=parseNumber(this.location.top||this.el.css("top"));this.location.bottom=parseNumber(this.location.bottom||this.el.css("bottom"));this.location.left=parseNumber(this.location.left||this.el.css("left"));this.location.right=parseNumber(this.location.right||this.el.css("right"));if(this.location.top!=="false"&&this.location.bottom!=="false"){var height=op.height()-this.location.top-this.location.bottom;this.height=isNaN(height)?this.height:height}if(this.location.left!=="false"&&this.location.right!=="false"){var width=op.width()-this.location.left-this.location.right;this.width=isNaN(width)?this.width:width}this.el.css($.grep(this.location,function(k,v){return v==="false"}));var self=this;function resizeEvt(){if(self.location.top!=="false"&&self.location.bottom!=="false"){self.height=op.height()-self.location.top-self.location.bottom}if(self.location.left!=="false"&&self.location.right!=="false"){self.width=op.width()-self.location.left-self.location.right}var css={};isNaN(self.height)||(css.height=self.height);isNaN(self.width)||(css.width=self.width);self.el.css(css)}$(window).resize(resizeEvt)}},loadIframe:function(iframeSrc){this.iframeSrc=iframeSrc||this.iframeSrc;var contentEl=this.contentEl;this.iframe=$('<iframe border="0" frameborder="0" cellspacing="0" src="about:blank" style="overflow:auto;width:100%;height:100%;border:none;background-color:transparent;" allowTransparency="true"></iframe>');this.iframe.attr("id","iframe"+this.id);this.iframe.attr("name","iframe"+this.id);this.contentEl.addClass("jq-container-iframe");this.iframeDom=this.iframe[0];this.iframeDom.src=this.iframeSrc;this.contentEl.append(this.iframe)},reloadIframe:function(){this.iframeDom.src=this.iframeSrc},setSrc:function(src){this.iframeSrc=src;this.iframeDom.src=src},setHtml:function(html){this.html=html;this.contentEl.html(this.html)},doLayout:function(){var self=this;if(this.layout){if(T9.layouts.register[this.layout]){if(!T9.isCmp(this.layoutMgr)){this.layoutCfg.el=this.contentEl;this.layoutCfg.items=this.items;this.layoutCfg.owner=this;this.layoutMgr=new T9.layouts.register[this.layout](this.layoutCfg)}T9.compose(this,this.layoutMgr)}}},doPlugins:function(){var t=this;$.each(this.plugins,function(i,e){if(T9.Plugins[e]){T9.Plugins[e].apply(t,arguments)}})},compose:function(){var self=this;return{addItems:self.addItems,doSortable:self.doSortable,doLayout:self.doLayout,reloadIframe:self.reloadIframe,loadIframe:self.loadIframe,setSrc:self.setSrc,autoLoad:self.autoLoad,sortItems:self.sortItems,setHtml:self.setHtml}},destroy:function(){if(this.iframeDom){this.iframeDom.src="about: blank"}T9.Component.prototype.destroy.call(this)}})})(jQuery);(function($){var btnOpts={adaptive:false,cls:"",toggle:false,toggleHandler:[],icon:"",title:"",btnText:"",event:"click",handler:$.noop,normalCls:"",activeCls:"",title:""};T9.createComponent("Button",btnOpts,T9.Component.prototype,{initComponent:function(){var self=this;this.btn=$('<button class="jq-button"></button>');this.btn.attr("title",this.title);this.btn.addClass(this.btnCls);if(this.status.isPressed){this.btn.addClass(this.activeCls)}else{this.btn.addClass(this.normalCls)}this.el.append(this.btn);if(this.icon){var img=$('<img align="absmiddle"></img>');img.attr("src",this.icon);this.btn.append(img)}if(this.btnText){var span=$("<span></span>").text(this.btnText);this.btn.append(span)}this.toggleHandler[0]=this.toggleHandler[0]||$.noop;this.toggleHandler[1]=this.toggleHandler[1]||$.noop;if(this.toggle){this.btn.click(function(e){var btn=this;if(!self.status.isPressed){self.status.isPressed=true;self.btn.removeClass(self.normalCls).addClass(self.activeCls);self.toggleHandler[0](e,self)}else{self.status.isPressed=false;self.btn.addClass(self.normalCls).removeClass(self.activeCls);self.toggleHandler[1](e,self)}})}else{this.btn.bind(this.event,function(e){self.handler(e,self)})}},disable:function(){this.btn[0].setAttribute("disabled",true)},enable:function(){this.btn[0].removeAttribute("disabled")},setStatus:function(status,disabled){this.status.isPressed=!(status=="default");if(this.status.isPressed){this.btn.removeClass(this.normalCls).addClass(this.activeCls)}else{this.btn.addClass(this.normalCls).removeClass(this.activeCls)}disabled||this.btn[0]&&this.btn[0].removeAttribute("disabled")}})})(jQuery);(function($){var menuOpts={data:[],items:[],el:null,icon:false,activeMenu:0,openUrl:$.noop,expandType:0,isLazyLoad:false,lazyLoadData:$.noop,animate:true,classes:[],liClass:[],selClass:"",expClass:[]};T9.createComponent("Menu",menuOpts,T9.Component.prototype,{initComponent:function(){this.items=this.data;this.createUL(this.items,0,this.el)},createUL:function(items,lv,container){var ul=$("<ul></ul>");var self=this;container.append(ul);if(this.classes[lv]){ul.attr("class",this.classes[lv])}$.each(items,function(i,e){var a=$('<a href="javascript:void(0)"></a>');var li=$("<li></li>").append(a);li.data("id",e.id);e.li=li;ul.append(li);self.addMethod(e);if(!e.leaf){li.attr("class",self.liClass[lv]);if(!self.isLazyLoad&&e.children){var temp=$('<li style="height:auto;display:none;"></li>');li.after(temp);self.createUL.call(self,e.children,lv+1,temp)}}if(e.icon&&self.icon){var img=$("<img></img>");img.attr("src",e.icon);a.append(img)}var span=$("<span></span>").html(e.text);a.append(span);if(e.id==self.activeMenu||e.active){self.menuClick(e,lv,li,false)}a[0].onclick=function(){self.menuClick(e,lv,li);return false}})},addMethod:function(e){e.show=function(){e.li.show()};e.hide=function(){e.li.hide()};e.setText=function(text){e.text=text;a.html(text)}},menuClick:function(menu,lv,li,animate){if(animate==undefined){animate=this.animate}if(menu.handleClick){menu.handleClick(menu,this)}else{if(!!menu.leaf){this.solveLastClick(li);this.openUrl(menu,this)}else{if(this.isLazyLoad){if(!li.data("expend")){li.data("expend",true);if(!li.data("opened")){var data=this.lazyLoadData(menu,this);li.after('<li style="height:auto;display:none;"></li>');var container=li.next();this.createUL(data,lv+1,container);container.show(animate?this.speed||500:0);li.data("opened",true)}else{li.next().show(animate?this.speed||500:0)}this.solveLastExpand(li,lv)}else{li.next().hide(this.speed||500);li.removeClass(this.expClass[lv]);li.data("expend",false)}}else{if(!li.data("expend")){li.data("expend",true);li.next().show(animate?this.speed||500:0);this.solveLastExpand(li,lv)}else{li.next().hide(this.speed||500);li.removeClass(this.expClass[lv]);li.data("expend",false)}}}}},solveLastClick:function(li){if(this.lastClick){this.lastClick.removeClass(this.selClass)}this.lastClick=li;li.addClass(this.selClass)},solveLastExpand:function(li,lv){if(!this.lastExpand){this.lastExpand=[null,null,null]}li.addClass(this.expClass[lv]);if(!this.expandType){if(this.lastExpand[lv]&&this.lastExpand[lv]!=li){this.lastExpand[lv].removeClass(this.expClass[lv]);this.lastExpand[lv].next().hide(this.speed||500);this.lastExpand[lv].data("expend",false)}this.lastExpand[lv]=li}},openUrl:$.noop})})(jQuery);(function($){var gridOpts={title:"",data:"",cls:"",url:"",params:{},maxRecords:5,lineHeight:25,listeners:{initRows:{before:function(e,t){if(!t.data||!t.data.length){t.el.append('<div class="nodata"><span>暂无数据...</span></div>');var h=t.maxRecords*t.lineHeight+"px";t.el.css({height:h,"line-height":h,"text-align":"center","font-size":"18px"})}}}},renderTo:null};T9.createComponent("Grid",gridOpts,T9.Component.prototype,{initComponent:function(){var t=this;this.initRows();this.el.css({height:this.maxRecords*this.lineHeight+"px"})},rowRender:function(i,e){var content=$("<div></div>");$.each(e.cells||[],function(index,el){var element;if(el.type==""||el.type.toLowerCase()=="text"){element=$("<span></span>");element.html(el.text)}else{if(el.type.toLowerCase()=="link"||el.type.toLowerCase()=="img"){element=$("<a></a>");element.html(el.text)}else{elment=$("<span></span>")}}T9.addPros(element,el);content.append(element)});return content},initRows:function(){var ul=$("<ul></ul>");ul.appendTo(this.el);var self=this;$.each(this.data||[],function(i,e){if(i>=self.maxRecords){return}var li=$("<li></li>");var liContent=self.rowRender(i,e);li.append(liContent);li.appendTo(ul)})}});T9.Image=function(cfg){var opts={title:"",path:"",cls:"",listeners:{click:$.noop},describe:"",listeners:{}};$.extend(true,this,opts,cfg);this.initialize()};$.extend(T9.Image.prototype,new T9.Component(),{initialize:function(){this.el.css({"text-align":"center"});this.el.attr("class",this.cls);var a=$('<a href="javascript:void(0)" style="display:block;"></a>');a.click(this.listeners.click);var img=$("<img></img>");if(this.path){img.attr("src",this.path);a.append(img)}var describe="";if(this.describe){describe=this.describe}this.el.append(a).append(describe);if(this.renderTo){this.renderTo.append(el)}},render:function(el){if(el){this.el.appendTo(el)}}});T9.register.image=T9.Image;var customOpts={title:"",url:"",params:{},data:null,renderCmp:$.noop};T9.createComponent("Custom",customOpts,T9.Component.prototype,{initComponent:function(){}});var imgBoxOpts={title:"",cls:"",imgSize:{height:125,width:225},maxRecords:5,delay:3000,loader:null,data:null,params:{},renderTo:null,listeners:{initContent:{before:function(e,t){if(!t.data||!t.data.length){t.el.append('<div class="nodata" style="line-height: 125px"><span>暂无数据...</span></div>');var h="125px";t.el.css({height:h,"line-height":h,"text-align":"center","font-size":"18px"})}}}}};T9.createComponent("ImgBox",imgBoxOpts,T9.Component.prototype,{initComponent:function(){this.el.addClass("t9-imgbox");this.container=$('<div class="t9-imgbox-container"></div>');this.imgs=$('<div class="t9-imgbox-imgs"></div>');var div=$('<div class="t9-imgbox-texts"></div>');this.texts=$("<ul></ul>");this.el.append(this.container.append(this.imgs).append(div.append(this.texts)));this.initContent();this.initScroll();this.initMouseEvent()},initScroll:function(){this.doScroll();this.imgsHeight=(this.data.length>5?this.maxRecords:this.data.length)*this.imgSize.height;this.scrollHeight=0},scroll:function(){this.scrollHeight+=this.imgSize.height;if(this.scrollHeight>this.imgsHeight-this.imgSize.height){this.scrollHeight=0}this.imgs.stop().animate({top:-this.scrollHeight},"slow");this.doScroll()},doScroll:function(){var t=this;this.task=setTimeout(function(){t.scroll.call(t)},t.delay)},initMouseEvent:function(){var imgs=this.texts.children();var t=this;$.each(imgs||[],function(i,e){$(e).mouseover(function(){clearTimeout(t.task);var top=i*t.imgSize.height;t.imgs.stop().animate({top:-top},"normal")});$(e).mouseout(function(){t.doScroll()})})},initContent:function(){if(this.data){var t=this;$.each(this.data,function(i,el){if(i>=t.maxRecords){return}var e=el.cells[0];var a4Img=$("<a></a>");var img=$("<img></img>");a4Img.append(img);t.imgs.append(a4Img);var li=$("<li></li>");var a4Text=$("<a></a>");var span=$("<span></span>");span.html(e.text);a4Text.append(span);t.texts.append(li.append(a4Text));T9.addPros(img,e);T9.addPros(a4Text,e);T9.addPros(a4Img,e)})}}})})(jQuery);(function($){var panelOpts={extendContainer:true,width:300,height:300,layout:"autolayout",layoutCfg:{},icon:"",tbar:[{id:"close"}],cls:"",left:0,containment:"parent",top:0,autoWidth:false,cmpCls:"jq-panel",renderTo:null,borderHeight:50,style:{},"float":false,tools:[],activeCls:"window-active",lazyContainer:false,autoHideBorders:false,autoHideToolbar:false,isMaximize:false,listeners:{resize:$.noop}};$(window).resize(function(){$.each(T9.components,function(k,v){if(v.status&&v.status.fillCtn||v.status.maximize){v.maxEvt&&v.maxEvt()}})});T9.createComponent("Panel",panelOpts,T9.Component.prototype,{initComponent:function(){this.el.addClass("extend-container");if(typeof this.height==="string"&&/^[0-9]{1,}$/.test(this.height)){this.height*=1}if(typeof this.width==="string"&&/^[0-9]{1,}$/.test(this.width)){this.width*=1}this.doRender();if(T9.browser.isIE6&&this["float"]){this.ie6Mask=$('<iframe border="0" frameborder="0" cellspacing="10" class="ie6mask" src="about:blank"></iframe>');var self=this;self.el.append(self.ie6Mask);setTimeout(function(){self.ie6Mask.css({height:self.el.innerHeight()-12,width:self.el.innerWidth()-12})},100)}},refresh:function(){this.status.container=false;T9.Component.prototype.refresh.apply(this,arguments)},doRender:function(){var css={height:"auto"};if(!this.autoWidth){css.width=this.width}this.el.css(css);this.createHeader();this.createBody();this.lazyContainer||this.doContainer();this.createFooter();if(this.draggable){this.clickActive()}},doInitStatus:function(){if(this.autoHideBorders){this.setAutoHideBorders()}if(this.autoHideTools){this.setAutoHideTools()}if(this.isPin){this.pin();this.tools.pin&&this.tools.pin.hide()}else{this.tools.unpin&&this.tools.unpin.hide()}if(this.top||this.left||this.right||this.bottom){this.posCenter=false}if(this.posCenter){var ctn;if(!this.containment||this.containment=="parent"){ctn=(this.parentCmp||this.parentEl)?"parent":null}else{ctn=$(this.containment)}this.setPosCenter(ctn)}else{this.el.css({left:this.left,top:this.top,bottom:this.bottom,right:this.right})}if(!this.isFillCtn&&!this.isMaximize){this.tools.restore&&this.tools.restore.hide()}else{if(this.isFillCtn){this.tools.plus&&this.tools.plus.hide();this.maximize(this.containment)}else{if(this.isMaximize){this.tools.maximize&&this.tools.maximize.hide();this.maximize()}}}this.doDbclick()},doDbclick:function(){var self=this;if(this.tools.plus&&this.tools.restore){this.headerEl.dblclick(function(){if(self.status.maximize){return}if(self.status.fillCtn){self.restore();self.tools.restore&&self.tools.restore.hide();self.tools.plus&&self.tools.plus.show()}else{self.maximize(self.containment);self.tools.restore&&self.tools.restore.show();self.tools.plus&&self.tools.plus.hide()}})}else{if(this.tools.maximize){this.headerEl.dblclick(function(){if(self.status.maximize){self.restore()}else{self.maximize()}})}}},doDraggable:function(){if(this.draggable){if(typeof this.draggable=="boolean"){this.draggable={}}if(typeof this.draggable.containment==="undefined"){this.draggable.containment="body"}}T9.Component.prototype.doDraggable.call(this)},clickActive:function(){this.status.clickActive=true;var self=this;this.el.mousedown(function(){self.active()})},doResizable:function(){var self=this;if(this.resizable){if(!this.modal){var mask=$(".draggable-mask");if(!mask.length){mask=$('<div class="draggable-mask"></div>');$("body").append(mask)}(typeof this.resizable==="object")||(this.resizable={});this.resizable.start=function(e,ui){mask.css({"z-index":self.zIndex});mask.show()}}this.resizable.alsoResize=this.resizable.alsoResize||this.contentEl;this.resizable.minWidth=this.resizable.minWidth||this.minWidth||200;this.resizable.minHeight=this.resizable.minHeight||this.minHeight||100;T9.Component.prototype.doResizable.call(this);this.el.resizable("option",{stop:function(e,ui){self.contentEl.css({width:"100%"});self.height=self.contentEl.height();self.width=self.el.width();self.el.css({height:"auto"});if(!self.modal){$(".draggable-mask").hide()}}});this.el.css({position:"absolute"})}},setPosCenter:function(ctn){ctn=ctn||$("body");if(ctn=="parent"){ctn=this.getParentEl()}ctn=$(ctn);if(ctn[0]&&ctn[0].tagName=="BODY"){ctn=$("body")}T9.Panel.lastLeft=T9.Panel.lastLeft||0;T9.Panel.lastTop=T9.Panel.lastTop||0;var scrollTop=document.documentElement.scrollTop||document.body.scrollTop;this.top=(ctn.height()-this.el.height()-100)/2+scrollTop+(T9.Panel.lastTop+=0);this.left=(ctn.width()-this.el.width())/2+(T9.Panel.lastLeft+=0);this.top=this.top<0?0:this.top;var pos=ctn.position();this.top+=pos.top;this.left+=pos.left;this.el.css({top:this.top,left:this.left})},toggle:function(speed){this.el.toggleClass(this.cmpCls+"-collapsed");this.contentEl.toggle(speed)},createHeader:function(){this.headerEl=$('<div class="'+this.cmpCls+'-header"></div>');this.headerEl.addClass("drag-handle");this.initTools();var title=$("<span></span>");if(this.icon){var img=$("<img></img>");img.attr("src",this.icon);img.attr("align","absmiddle");this.headerEl.append(img)}else{if(this.iconCls){var div=$('<div style="float: left;"></div>');div.addClass(this.iconCls);this.headerEl.append(div)}}title.attr("class",this.cmpCls+"-header-text");title.append(this.title);this.headerEl.append(title);var tl=$('<div class="'+this.cmpCls+'-tl"></div>');var tr=$('<div class="'+this.cmpCls+'-tr"></div>');var tc=$('<div class="'+this.cmpCls+'-tc"></div>');tl.append(tr);tr.append(tc);tc.append(this.headerEl);this.el.append(tl)},createBody:function(){this.contentEl=$('<div class="'+this.cmpCls+'-content"></div>');this.contentEl.css({height:this.height});var mc=$('<div class="'+this.cmpCls+'-mc"></div>');var ml=$('<div class="'+this.cmpCls+'-ml"></div>');var mr=$('<div class="'+this.cmpCls+'-mr"></div>');this.el.append(ml.append(mr.append(mc)));mc.append(this.contentEl)},doContainer:function(reload){if(!this.status.container||reload){var t=this;this.container=new T9.Container({renderTo:t.contentEl,items:t.items,url:t.url,html:t.html,loadCallback:t.loadCallback,iframeSrc:t.iframeSrc||t.src,layout:t.layout,param:t.param,layout:t.layout,owner:t,layoutCfg:t.layoutCfg,contentEl:t.content});T9.compose(this,this.container);this.status.container=true}},createFooter:function(){var bl=$('<div class="'+this.cmpCls+'-bl"></div>');var br=$('<div class="'+this.cmpCls+'-br"></div>');var bc=$('<div class="'+this.cmpCls+'-bc"></div>');var bcP=$('<div class="'+this.cmpCls+'-pointer-bc"></div>');bl.append(br);br.append(bc);this.el.append(bl);this.pointerBc&&this.el.append(bcP)},maximize:function(ctn){var type=!!ctn?"fillCtn":"maximize";ctn=ctn||$("body");if(ctn=="parent"){ctn=this.parentEl}ctn=$(ctn);if(!this.status.fillCtn&&!this.status.maximize){if(this.status.initialized){this.left=this.el.position().left;this.top=this.el.position().top}this.replacer={};this.replacer.offset=this.el.offset();this.replacer.css={height:this.contentEl.css("height"),width:this.el.css("width"),position:this.el.css("position")}}this.drag&&this.drag.disable();this.resize&&this.resize.disable();if(type=="maximize"){this.layer="middle"}else{this.layer="lower"}!this.status.hidden&&this.active();this.maximize.height=ctn.height()-this.borderHeight||50;var css=ctn.position();var h;if(this.layout=="cardlayout"&&this.layoutCfg.tabs){h=this.maximize.height}else{h=this.maximize.height}if(this.animate&&!this.status.hidden){var self=this;this.contentEl.find(".jq-container-iframe").hide();this.el.animate({width:ctn.width(),left:css.left},"fast",function(){self.contentEl.animate({height:h},"fast");self.el.animate({top:css.top},"fast",function(){self.contentEl.find(".jq-container-iframe").show()})})}else{this.contentEl.height(h);css.width="100%";this.el.css(css)}this.status.fillCtn=this.status.maximize=false;this.status[type]=true},getCrtHeight:function(){if(this.status.fillCtn||this.status.maximize){return this.maximize.height}return this.height},restore:function(){this.status.fillCtn=this.status.maximize=false;if(this.replacer){this.el.css({height:"auto",position:this.replacer.css.position});if(this.animate&&!this.status.hidden){var self=this;this.contentEl.find(".jq-container-iframe").hide();this.el.animate({top:this.top},"fast");this.contentEl.animate({height:this.replacer.css.height},"fast",function(){self.el.animate({left:self.left,width:self.replacer.css.width},"fast",function(){self.contentEl.find(".jq-container-iframe").show()})})}else{this.contentEl.css({height:this.replacer.css.height});this.el.css({left:this.left,top:this.top,width:this.replacer.css.width})}(this.el.parent()[0]!=$(this.parentEl)[0])&&this.el.appendTo(this.parentEl)}this.drag&&this.drag.enable();this.drag&&this.resize.enable();this.active("lower")},maxEvt:function(){var ctn;if(this.status.fillCtn){var ctn;if(!this.containment||this.containment=="parent"){ctn=this.parentEl}else{ctn=$(this.containment)}}else{if(this.status.maximize){ctn=$("body")}else{return}}this.el.width(ctn.width());this.maximize.height=ctn.height()-this.borderHeight||50;this.contentEl.height(this.maximize.height)},minimize:function(){this.hide()},pin:function(){this.active("upper")},unpin:function(){this.active("lower")},autoLoad:function(){},getAbsContentHeight:function(){return this.contentEl.height()+"px"},getTitle:function(){return this.title||""},setTitle:function(title){this.title=title||"";this.headerEl.find("span").html(this.title)},setWidth:function(width){this.width=width;this.el.css({width:this.width})},setHeight:function(height){this.height=height;this.contentEl.css({height:this.height})},scrollIn:function(speed,callback){var top=(this.status.fillCtn||this.status.maximize)?0:this.top;this.el.css({top:(document.documentElement||document.body).clientHeight+"px"});this.el.show();this.el.animate({top:top},speed||"slow",function(){callback&&callback()})},scrollOut:function(speed,callback){var self=this;var top=(this.status.fillCtn||this.status.maximize)?0:this.top;this.el.animate({top:(document.documentElement||document.body).clientHeight+"px"},speed||"slow",function(){self.el.hide();self.el.css({top:top});callback&&callback()})},collapse:function(speed,callback){var self=this;var top=this.getPosY();var height=this.getCrtHeight();this.el.stop().animate({top:parseInt(top+this.getCrtHeight())/2},speed);this.contentEl.stop().animate({height:0},speed,function(){self.el.css({display:"none"});self.contentEl.css({height:height});self.el.css({top:top});callback&&callback()});this.contentEl.find(".jq-container-iframe").hide()},expand:function(speed,callback){var self=this;var height=this.getCrtHeight();this.contentEl.css({height:0});this.el.show();var top=this.getPosY();this.el.css({top:top+parseInt(this.getCrtHeight())/2});this.el.stop().animate({top:top},speed,function(){});this.contentEl.stop().animate({height:height},speed,function(){self.doContainer();self.contentEl.find(".jq-container-iframe").show();callback&&callback()})},close:function(speed){var self=this;if(this.container&&this.container.iframeDom){var button=document.getElementById("buttonId");function unload(){setTimeout(function(){self.hide(speed,function(){self.destroy()})},0)}try{var conWin=this.container.iframeDom.contentWindow;if(conWin&&this.iframeUnload){}else{if(conWin.addEventListener){conWin.addEventListener("unload",unload,false)}else{if(conWin.attachEvent){conWin.attachEvent("onunload",unload)}else{this.hide(speed,function(){self.destroy()})}}}}catch(e){unload()}finally{}this.container.iframeDom.src="about:blank";this.iframeUnload=true}else{this.hide(speed,function(){self.destroy()})}},initTools:function(){var tools=this.tbar||[];var t=this;t.tools={};$.each(tools,function(i,e){if(T9.Tools[e.id]){t.tools[e.id]={el:$('<a href="javascript:void(0)">&nbsp;</a>'),show:function(){this.el.show()},hide:function(){this.el.hide()},initTool:function(){t.headerEl.append(this.el);this.el.attr("class","jq-tool jq-tool-"+e.id);this.el.attr("title",T9.Tools[e.id].title);if(e.hidden){this.hide()}this.el.bind("click",function(){if(!e.preventDefault){T9.Tools[e.id].defaultHandler(e,t.tools[e.id].el,t,e.params)}if(e.handler){e.handler(e,t.tools[e.id].el,t,e.params)}return false})}};t.tools[e.id].initTool()}})},active:function(layer){this.layer=layer||this.layer;this.zIndex=T9.topZIndex(this.layer);this.el.css({"z-index":this.zIndex});this.addClass(this.activeCls);this.status.hidden&&this.show()},deactive:function(){this.removeClass(this.activeCls)},hide:function(speed,callback){if(this.status.hidden){callback&&callback();return}var self=this;this.trayBtn&&this.trayBtn.disable();this.hideEffect(speed,function(){self.trayBtn&&self.trayBtn.enable();callback&&callback()});this.status.hidden=true},show:function(speed,callback){if(this.status.hidden){this.status.hidden=false;var self=this;this.trayBtn&&this.trayBtn.disable();this.showEffect(speed,function(){self.trayBtn&&self.trayBtn.enable();callback&&callback()})}},setAutoHideTools:function(){var self=this;this.headerEl.hide();this.el.hover(function(){self.headerEl.show()},function(){self.headerEl.hide()})},setAutoHideBorders:function(){this.el.addClass("window-tsp");this.el.hover(function(){$(this).removeClass("window-tsp")},function(){$(this).addClass("window-tsp")})},destroy:function(){if(this.container&&this.container.iframeDom){this.container.iframeDom.src="about:blank"}T9.Component.prototype.destroy.call(this)}})})(jQuery);(function($){var tipOpts={event:"mouseOver",html:"",content:null,delay:5,relative:{x:10,y:10},"float":true,items:null,cmpCls:"jq-tip",extendContainer:true,layout:"autolayout",layoutCfg:{},icon:"",cls:"",renderTo:"body",style:{},tools:[]};T9.createComponent("Tip",tipOpts,T9.Panel.prototype,{initComponent:function(){if(!this.target){this.destroy();return}this.target=$(this.target);T9.Panel.prototype.initComponent.apply(this,arguments);this.events[this.event].call(this)},doInitStatus:function(){this.el.css({position:"absolute","z-index":T9.topZIndex("upper"),display:"none"});this.status.hidden=true},events:{mouseOver:function(){var self=this;this.target.bind("mousemove",function(evt){self.setPosition({top:evt.clientY+self.relative.y,left:evt.clientX+self.relative.x});self.el.css({display:"block"})});this.target.bind("mouseout",function(){self.el.css({display:"none"})})},leftClick:function(){var self=this;this.target.bind("click",function(evt){self.setPosition({top:self.target.offset().top+self.relative.y,left:self.target.offset().left+self.target.width()+self.relative.x});self.show();clearTimeout(self.timer);self.timer=setTimeout(function(){self.hide()},self.delay*1000)});self.el.bind("mouseover",function(){clearTimeout(self.timer);return false}).bind("mouseout",function(){clearTimeout(self.timer);self.timer=setTimeout(function(){self.hide()},self.delay*1000)})},rightClick:function(){var self=this;this.target.bind("contextmenu",function(e){self.show();self.setPosition({left:e.clientX,top:e.clientY});clearTimeout(self.timer);self.timer=setTimeout(function(){self.hide()},self.delay*1000);return false});self.el.bind("mouseover",function(){clearTimeout(self.timer)}).bind("mouseout",function(){clearTimeout(self.timer);self.timer=setTimeout(function(){self.hide()},self.delay*1000)})}},setPosition:function(pos){var h=parseInt(this.getAbsHeight());var w=parseInt(this.getAbsWidth());var cw=parseInt((document.documentElement||document.body).clientWidth);var ch=parseInt((document.documentElement||document.body).clientHeight);var l=parseInt(pos.left);var t=parseInt(pos.top);if(l+w>cw-5){pos.left=l+(cw-5-l-w)}if(t+h>ch-5){pos.top=t-h}this.el.css(pos)}})})(jQuery);(function($){var opts={modal:false,draggable:{},width:300,id:"",tbar:[{id:"close"}],"float":true,borderHeight:40,modalCls:"",containment:"parent",activeCls:"window-active",renderTo:"body",cmpCls:"jq-window",height:300,maskOpacity:"0.5",closeAction:"close",src:"",posCenter:true,iframeSrc:"",icon:"",layer:"lower",layout:"autolayout",layoutCfg:{},plugins:[],cls:"",style:{},listeners:{resize:$.noop}};T9.createComponent("Window",opts,T9.Panel.prototype,{initComponent:function(){if(this.modal){this.layer="upper";this.createModalBg()}this.initContainer();T9.Panel.prototype.initComponent.call(this)},show:function(){T9.Panel.prototype.show.apply(this,arguments);this.modalBg&&this.modalBg.show()},hide:function(){T9.Panel.prototype.hide.apply(this,arguments);this.modalBg&&this.modalBg.hide()},close:function(){T9.Panel.prototype.close.apply(this,arguments)},initContainer:function(){this.el.addClass(this.cmpCls+"-container");this.el.css({width:this.width,"z-index":T9.topZIndex(this.layer)});var t=this;this.el.hide();this.status.hidden=true;if(t.modalBg){T9.Event.add(this,"bind","destroy","before",function(e,t){t.modalBg.remove()});$(window).resize(function(){t.modalBg.css({width:(document.documentElement||document.body).scrollWidth,height:(document.documentElement||document.body).scrollHeight})})}},createModalBg:function(){this.modalBg=$('<div class="'+this.cmpCls+'-mask"></div>');$("body").append(this.modalBg);var CSS={width:(document.documentElement||document.body).scrollWidth,height:(document.documentElement||document.body).scrollHeight,top:"0px","z-index":T9.topZIndex(this.layer),left:"0px",display:"none",opacity:this.maskOpacity,filter:"alpha(opacity="+this.maskOpacity*100+");WIDTH: 100%"};this.modalBg.css(CSS);this.modalBg.addClass(this.modalCls);if(this.modalStyle){this.modalBg.css(this.modalStyle)}}});var windowMrgOpts={tray:null,container:null,items:[],activeWindow:null,activeBtn:null};T9.createComponent("WindowMgr",windowMrgOpts,{initialize:function(){var self=this;$.each(this.items,function(i,e){self.addTrayBtn(e)})},addTrayBtn:function(win){var self=this;if(this.tray&&!win.trayBtn){var btn=new T9.Button({status:{isPressed:!win.status.hidden},normalCls:"btn-icon",activeCls:"btn-icon-active",icon:win.icon,text:win.title,toggle:true,title:win.title,toggleHandler:[function(e,t,callback){win.show("normal",callback);win.active()},function(e,t,callback){win.hide("normal",callback)}]});T9.Event.add(btn,"bind","destroy","before",function(e,t){self.tray.items=$.grep(self.items,function(n,i){return n.id!=t.id})});win.trayBtn=btn;this.tray.addItems(btn)}function doActive(e,t){if(!self.activeWindow){self.activeWindow=t;t.trayBtn.setStatus("active",true)}else{if(self.activeWindow.id!=t.id){self.activeWindow.trayBtn&&self.activeWindow.trayBtn.setStatus("default",true);self.activeWindow.deactive();self.activeWindow=t;t.trayBtn.setStatus("active",true)}}}function doHide(e,t){var id="",max=0;$.each(self.items,function(i,e){if(!e.status.hidden&&e.id!=t.id){if((e.zIndex||0)>max){max=e.zIndex||0;id=e.id}}});if(id){T9.getCmp(id).active()}else{t.trayBtn&&t.trayBtn.setStatus("default",true)}}T9.Event.add(win,"bind","active","after",doActive);T9.Event.add(win,"bind","hide","after",doHide);T9.Event.add(win,"bind","destroy","before",function(e,t){self.items=$.grep(self.items,function(n,i){return n.id!=t.id});t.trayBtn&&t.trayBtn.destroy()})},addItems:function(windows){var self=this;if(windows instanceof Array){$.each(windows,function(i,e){self.items.push(e);self.addTrayBtn(e)})}else{this.items.push(windows);this.addTrayBtn(windows)}},createWindow:function(cfg){var win=T9.getCmp(cfg&&cfg.id);if(!win){win=new T9.Window(cfg);win.el.addClass(this.cls);this.addItems(win)}win.active()},createPanel:function(cfg){if(!T9.isCmp(cfg.parentCmp)){return}var panel=new T9.Panel(cfg);this.addItems(panel);panel.active()},hideAll:function(){$.each(this.items,function(i,e){e.hide()})},removeAll:function(){$.each(this.items,function(i,e){T9.isCmp(e)&&e.destroy()})},showAll:function(){$.each(this.items,function(i,e){e.show()})},getActive:function(){return this.activeWindow}})})(jQuery);